---
title: "Part 3: Single Neuron Modeling"
subtitle: "Deep Dive into Neuron Models with Neun"
format:
  html:
    toc: true
    toc-depth: 3
    code-fold: show
---

## Introduction

In this section, we'll explore single neuron models in depth, understanding their properties, behaviors, and how to use them effectively with Neun. While single neurons may seem simple, they exhibit rich dynamics that are essential for understanding network behavior.

## The Hodgking-Huxley Model

### Review of the Model

### Response to Different Input Patterns

#### Subthreshold Responses

#### Spike Generation

```python
# Explore spike generation with increasing currents

```

### F-I Curve Analysis

The relationship between input current and firing rate is fundamental:

```python
# Compute F-I curve

```

::: {.callout-tip}
## Understanding F-I Curves

The F-I curve tells us:

- **Rheobase**: Minimum current for spiking
- **Gain**: Slope of the curve (sensitivity to input)
- **Saturation**: Maximum firing rate (limited by refr period)
- **Linearity**: Linear for LIF, nonlinear for other models
:::

## The Izhikevich Model

The Izhikevich model can reproduce many different firing patterns with just 4 parameters:

$$
\begin{aligned}
\frac{dV}{dt} &= 0.04V^2 + 5V + 140 - u + I \\
\frac{du}{dt} &= a(bV - u)
\end{aligned}
$$

When $V \geq 30$ mV: $V \to c$, $u \to u + d$

### Different Neuron Types

```python
# Dictionary of Izhikevich parameters for different cell types
neuron_types = {
    'Regular Spiking (RS)': {
        'a': 0.02, 'b': 0.2, 'c': -65, 'd': 8,
        'I_amp': 10, 'color': 'blue'
    },
    'Intrinsically Bursting (IB)': {
        'a': 0.02, 'b': 0.2, 'c': -55, 'd': 4,
        'I_amp': 10, 'color': 'green'
    },
    'Chattering (CH)': {
        'a': 0.02, 'b': 0.2, 'c': -50, 'd': 2,
        'I_amp': 10, 'color': 'red'
    },
    'Fast Spiking (FS)': {
        'a': 0.1, 'b': 0.2, 'c': -65, 'd': 2,
        'I_amp': 10, 'color': 'purple'
    },
    'Low-Threshold Spiking (LTS)': {
        'a': 0.02, 'b': 0.25, 'c': -65, 'd': 2,
        'I_amp': 10, 'color': 'orange'
    },
    'Resonator (RZ)': {
        'a': 0.1, 'b': 0.26, 'c': -65, 'd': 2,
        'I_amp': 3.5, 'color': 'brown'
    }
}

# Simulate and plot
```

::: {.callout-important}
## Choosing Parameters

Izhikevich parameters:

- **a**: Recovery time scale (0.01-0.1)
- **b**: Sensitivity of u to V (0.2-0.25)
- **c**: Reset voltage (-65 to -50 mV)
- **d**: Reset shift of u (2-8)

Different combinations produce different firing patterns!
:::

### Response to Synaptic-like Input

```python
# Simulate response to alpha-function input (like a synaptic event)

```

## Noise and Variability

Real neurons operate in noisy environments. Let's explore how noise affects spiking:

### Noisy Input Current

```python
# Compare responses to clean vs noisy input

```

### Coefficient of Variation (CV) of ISI

The CV quantifies spike time variability:

```python
# Analyze spike time variability

```

::: {.callout-tip}
## Interpreting CV

- **CV â‰ˆ 0**: Regular, clock-like firing
- **CV â‰ˆ 0.5-1**: Irregular, Poisson-like firing (typical in cortex)
- **CV > 1**: Highly variable, often bursting
:::

## Frequency Response

How do neurons respond to oscillatory inputs? This relates to the frequency-dependent responses discussed in Part 1.

```python
# Test neuron response to sinusoidal inputs at different frequencies

```

## Phase Response Curves (PRC)

The PRC characterizes how perturbations affect spike timingâ€”crucial for understanding synchronization.

```python
# Simplified PRC computation
def compute_PRC(neuron_params, I_base, perturbation=0.5):
    """Compute phase response curve."""
    dt = 0.1
    T = 500
    
    # Find natural period
    neuron = neun.LIFNeuron(**neuron_params)
    I_ext = np.ones(int(T/dt)) * I_base
    
    spikes = []
    neuron.reset()
    for step in range(len(I_ext)):
        if neuron.step(dt, I_ext[step]):
            spikes.append(step * dt)
    
    if len(spikes) < 2:
        return None, None
    
    T0 = np.mean(np.diff(spikes))  # Natural period
    
    # Test perturbations at different phases
    phases = np.linspace(0, 1, 20)
    phase_shifts = []
    
    for phase in phases:
        neuron = neun.LIFNeuron(**neuron_params)
        neuron.reset()
        
        # Run until first spike
        t = 0
        while t < 1000:
            if neuron.step(dt, I_base):
                break
            t += dt
        
        # Wait for desired phase
        t_wait = phase * T0
        t = 0
        while t < t_wait:
            neuron.step(dt, I_base)
            t += dt
        
        # Apply perturbation
        neuron.step(dt, I_base + perturbation)
        
        # Find next spike
        t_pert = t
        t = 0
        while t < T0 * 2:
            if neuron.step(dt, I_base):
                t_next = t
                break
            t += dt
        else:
            t_next = T0
        
        # Phase shift
        shift = (t_next - (T0 - t_wait)) / T0
        phase_shifts.append(shift)
    
    return phases, phase_shifts

# Compute and plot PRC
params = {'C_m': 1.0, 'g_L': 0.1, 'E_L': -70.0,
          'V_th': -50.0, 'V_reset': -70.0, 'tau_ref': 2.0}

phases, shifts = compute_PRC(params, I_base=2.5)

if phases is not None:
    fig, ax = plt.subplots(figsize=(10, 6))
    ax.plot(phases, shifts, 'o-', linewidth=2, markersize=6)
    ax.axhline(0, color='gray', linestyle='--', alpha=0.5)
    ax.set_xlabel('Phase (fraction of period)', fontsize=12)
    ax.set_ylabel('Phase Shift', fontsize=12)
    ax.set_title('Phase Response Curve (PRC)', fontsize=14)
    ax.grid(True, alpha=0.3)
    plt.tight_layout()
    plt.show()
```

::: {.callout-important}
## PRC Applications

PRCs are essential for understanding:

- **Synchronization**: How neurons lock to common rhythms
- **Network oscillations**: Emergence of population activity
- **Sensitivity to timing**: When inputs have maximal effect
- **Resonance**: Preferred input frequencies
:::

## Summary

In this section, we explored:

- âœ… HH model in detail: subthreshold responses, F-I curves
- âœ… Izhikevich model: diverse firing patterns
- âœ… Effects of noise on spiking
- âœ… Frequency responses
- âœ… Phase response curves

::: {.callout-note}
## Key Insights

1. **Model choice matters**: Different models for different questions
3. **Adaptation**: Dynamic sensitivity adjustment
4. **Noise**: Introduces variability, can be functional
5. **Frequency tuning**: Neurons filter temporal information
6. **PRCs**: Predict synchronization and timing effects
:::

## Exercises

1. **Explore parameter space**: How does varying Ï„_ref affect maximum firing rate?
2. **Resonance**: Find the frequency at which a neuron responds most strongly
3. **Stochastic resonance**: Can noise improve signal detection?

## Next Steps

Now we're ready to connect neurons into networks!

---

ðŸ‘‰ **Continue to [Part 4: Neural Networks](04-neural-networks.qmd)**
